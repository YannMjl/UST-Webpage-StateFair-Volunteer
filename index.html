<!DOCTYPE html>

<html lang="en">

    <head>

        <meta charset="UTF-8">
        <title>UST-StateFair</title>
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <!-- Adding CSS stilling to HTML  -->
        <!-- <link rel="stylesheet" href="./style.css"> -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">

        <!-- Connectiing Scripts to HTML  -->
        <script type="text/javascript" src="//code.jquery.com/jquery-1.11.3.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>

        <!-- Connecting javascript files -->
        <!-- <script type="text/javascript" src="./main.js"></script> -->

        <style>
            
            button {
                height: auto;
                width: auto;
                background-color: #8546b1;
                /* Green */
                border: none;
                color: #9e28b5;
                padding: 16px 32px;
                text-align: center;
                text-decoration: none;
                display: inline-block;
                font-size: 15px;
                margin: 4px 2px;
                -webkit-transition-duration: 0.4s;
                /* Safari */
                transition-duration: 0.4s;
                cursor: pointer;
                background-color: white;
                border: 3px solid #8546b1;
            }

            button:hover, .button:hover span {
                background-color: #8546b1;
                color: white;
                box-shadow: 0 12px 16px 0 rgba(0, 0, 0, 0.24),
                0 17px 50px 0 rgba(0, 0, 0, 0.19);
                padding-right: 25px;
            }

            .button span {
                cursor: pointer;
                display: inline-block;
                position: relative;
                transition: 0.5s;
            }

            .button span:after {
                content: '\00bb';
                position: absolute;
                opacity: 0;
                top: 0;
                right: -20px;
                transition: 0.5s;
            }

            .button:hover span:after {
                opacity: 1;
                right: 0;
            }

            strong {
                font-weight: bold;
                color: #510C76;
                font-size: 1.575rem;
            }

            h3 {
                color: #510C76;
                font-weight: 400;
                font-size: 1.5rem;
            }

            .right {
                float: right!important;
                margin-right: 1.5rem;
            }

            .left {
                float: left!important;
                padding-left: 20px;
            }

            .time {
                font-weight: bold;
                font-style: normal;
                font-size: 1.4rem;
            }

            .row {
                width: 50%;
                margin-left: -.75rem;
                margin-right: -.75rem;
                margin-top: 0;
                padding: 15px 0px;
                /* border-bottom: .075rem solid #e8e8e8; */
                border-top: .075rem solid #e8e8e8;
            }
        
        </style>

    </head>

    <body>

        <div class="container" >

            <h1 id="headerTitle" style="text-align: center;">2019 State Fair Volunteer Sign Up</h1>
            <p style="text-align: center;">
                University of St. Thomas State Fair Volunteer Sign-up. 
                Please review available time slots for UST community to volunteer at the state fair.
            </p>

            <div class="showSignUp">
                <h3 style="color: #8546b1; font-weight: bold; font-size: 2.8rem;">Event Details</h3>
            </div>

        </div>

        <script>
        
            // Do some stuff when page hmtl page is launched
            $(document).ready(

                function showEvent() {

                    var eventId = 'a3s56000000Mf6n',
                        viewStart = '2019-5-3+00:00:00',
                        viewEnd = '2019-12-3+00:00:00',
                        state_fair_2019_feed = 'https://staging-stthomas.cs42.force.com/applicantportal/services/apexrest/usteventfeed?eventId=a3s56000000Mf6n&feedType=eventList&viewStart=2019-6-3+00:00:00&viewEnd=2019-9-3+24:59:59';

                    $.ajax({

                        type: "GET",

                        url: state_fair_2019_feed,

                        data: {
                            'feedType': 'eventList',
                            'eventId': eventId,
                            'viewStart': viewStart.replace("+", " "),
                            'viewEnd': viewEnd.replace("+", " ")
                        },

                        dataType: "jsonP", // use JsonP for datatype if API does not have CORS set

                        error: function (e) {
                            alert("An error occurred while processing API calls");
                            console.log("API call Failed: ", e);
                        },

                        success: function (data) {

                            $.each(data, function (index, value) {

                                // get URL - Salesforce UST event management tool 
                                var _eventUrl = value.eventUrl;

                                // get Event details for sign up
                                var _startDate = new Date(value.start),
                                    _endDate = new Date(value.end);
                                var _datetext = _startDate.toDateString();

                                var _startTime = _startDate.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                                _endTime = _endDate.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });


                                $('.showSignUp').append(

                                    '<div class="row">' +

                                    '<div class="left">' +
                                    '<p style="display: inline; float: left;">' +
                                    '<strong>' + _datetext + '</strong><br>' +
                                    '<p class="time">' + _startTime + ' - ' + _endTime + '</p>' +
                                    '</p>' +
                                    '</div>' +

                                    '<div class="right">' +
                                    '<p style="margin: 0px 0px 0px 15px!Important; display: inline;">' +
                                    '<a href="' + _eventUrl + '" target="_blank" style="font-weight: bold; color: #9e28b5;">' +
                                    '<button class="button" style="vertical-align:middle"><span>Register </span></button>' +
                                    '</a>' +
                                    '</p>' +
                                    '</div>' +

                                    '</div>'

                                );

                            });

                        }

                    });
                }
            
            );

        </script>
  
    </body>

</html>